<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloudflare ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¬ãƒãƒ¼ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #f6821f 0%, #ff6b35 100%);
            color: white;
            padding: 40px 20px;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .period {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .updated {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab-button {
            flex: 1;
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .tab-button.active {
            background: linear-gradient(135deg, #f6821f 0%, #ff6b35 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
        
        .chart-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .chart-section h2 {
            margin-bottom: 10px;
            color: #333;
            font-size: 1.5em;
        }

        .chart-description {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        
        .alert-box {
            background: #fff3cd;
            border-left: 4px solid #f6821f;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-box h3 {
            color: #f6821f;
            margin-bottom: 10px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ›¡ï¸ Cloudflare ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¬ãƒãƒ¼ãƒˆ</h1>
            <div class="period">éå»7æ—¥é–“ã®ãƒ‡ãƒ¼ã‚¿</div>
            <div class="updated" id="last-updated">èª­ã¿è¾¼ã¿ä¸­...</div>
        </header>

        <div id="loading" class="loading">ğŸ“Š ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...</div>

        <div id="content" style="display: none;">
            <div class="tabs">
                <button class="tab-button active" onclick="switchTab('global')">ğŸŒ ã‚°ãƒ­ãƒ¼ãƒãƒ«</button>
                <button class="tab-button" onclick="switchTab('japan')">ğŸ‡¯ğŸ‡µ æ—¥æœ¬</button>
            </div>

            <!-- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¿ãƒ– -->
            <div id="global-tab" class="tab-content active">
                <div class="alert-box">
                    <h3>ğŸ“Š ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
                    <p>Layer 7ï¼ˆHTTPï¼‰æ”»æ’ƒã€Layer 3ï¼ˆDDoSï¼‰æ”»æ’ƒã€ãƒœãƒƒãƒˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º</p>
                </div>

                <div class="chart-section">
                    <h2>ğŸ“ˆ Layer 7æ”»æ’ƒãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆéå»7æ—¥é–“ï¼‰</h2>
                    <p class="chart-description">Layer 7æ”»æ’ƒï¼šWebã‚µã‚¤ãƒˆã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆHTTP/HTTPSï¼‰ã‚’ç‹™ã£ãŸæ”»æ’ƒã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚„XSSãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚</p>
                    <div class="chart-container">
                        <canvas id="globalL7TrendChart"></canvas>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>ğŸ”¥ Layer 3 DDoSæ”»æ’ƒãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆéå»7æ—¥é–“ï¼‰</h2>
                    <p class="chart-description">Layer 3æ”»æ’ƒï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã¸ã®æ”»æ’ƒã€‚å¤§é‡ã®ãƒ‘ã‚±ãƒƒãƒˆã§ã‚µãƒ¼ãƒãƒ¼ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’éº»ç—ºã•ã›ã‚‹DDoSæ”»æ’ƒãŒä»£è¡¨çš„ã§ã™ã€‚</p>
                    <div class="chart-container">
                        <canvas id="globalL3TrendChart"></canvas>
                    </div>
                </div>

                <div class="grid-3">
                    <div class="chart-section">
                        <h2>ğŸ›¡ï¸ Layer 7é˜²å¾¡æ‰‹æ³•</h2>
                        <p class="chart-description">WAFã€DDoSãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒœãƒƒãƒˆç®¡ç†ãªã©ã€Cloudflareã®å„ç¨®é˜²å¾¡æ©Ÿèƒ½ã«ã‚ˆã‚‹æ”»æ’ƒã®é®æ–­å‰²åˆã€‚</p>
                        <div class="chart-container">
                            <canvas id="globalL7MitigationChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-section">
                        <h2>âš¡ Layer 3ãƒ—ãƒ­ãƒˆã‚³ãƒ«åˆ¥</h2>
                        <p class="chart-description">UDPã€TCPã€ICMPãªã©ã€DDoSæ”»æ’ƒã«ä½¿ç”¨ã•ã‚ŒãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®å†…è¨³ã€‚</p>
                        <div class="chart-container">
                            <canvas id="globalL3ProtocolChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-section">
                        <h2>ğŸ¤– ãƒœãƒƒãƒˆ vs äººé–“</h2>
                        <p class="chart-description">Webãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å…¨ä½“ã®ã†ã¡ã€ãƒœãƒƒãƒˆï¼ˆè‡ªå‹•åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã¨äººé–“ã«ã‚ˆã‚‹é€šä¿¡ã®æ¯”ç‡ã€‚</p>
                        <div class="chart-container">
                            <canvas id="globalBotChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>ğŸ¯ æ”»æ’ƒå¯¾è±¡å›½ Top 10</h2>
                    <p class="chart-description">Layer 7æ”»æ’ƒã‚’æœ€ã‚‚å¤šãå—ã‘ã¦ã„ã‚‹å›½ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€‚å‰²åˆã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«æ”»æ’ƒç·æ•°ã«å¯¾ã™ã‚‹ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã€‚</p>
                    <div class="chart-container">
                        <canvas id="globalLocationChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- æ—¥æœ¬ã‚¿ãƒ– -->
            <div id="japan-tab" class="tab-content">
                <div class="alert-box">
                    <h3>ğŸ‡¯ğŸ‡µ æ—¥æœ¬å‘ã‘ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
                    <p>æ—¥æœ¬ã‚’å¯¾è±¡ã¨ã—ãŸæ”»æ’ƒãƒ‡ãƒ¼ã‚¿ã¨ãƒœãƒƒãƒˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯</p>
                </div>

                <div class="chart-section">
                    <h2>ğŸ“ˆ Layer 7æ”»æ’ƒãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆæ—¥æœ¬ãƒ»éå»7æ—¥é–“ï¼‰</h2>
                    <p class="chart-description">Layer 7æ”»æ’ƒï¼šWebã‚µã‚¤ãƒˆã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆHTTP/HTTPSï¼‰ã‚’ç‹™ã£ãŸæ”»æ’ƒã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚„XSSãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚</p>
                    <div class="chart-container">
                        <canvas id="japanL7TrendChart"></canvas>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>ğŸ”¥ Layer 3 DDoSæ”»æ’ƒãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆæ—¥æœ¬ãƒ»éå»7æ—¥é–“ï¼‰</h2>
                    <p class="chart-description">Layer 3æ”»æ’ƒï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã¸ã®æ”»æ’ƒã€‚å¤§é‡ã®ãƒ‘ã‚±ãƒƒãƒˆã§ã‚µãƒ¼ãƒãƒ¼ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’éº»ç—ºã•ã›ã‚‹DDoSæ”»æ’ƒãŒä»£è¡¨çš„ã§ã™ã€‚</p>
                    <div class="chart-container">
                        <canvas id="japanL3TrendChart"></canvas>
                    </div>
                </div>

                <div class="grid-3">
                    <div class="chart-section">
                        <h2>ğŸ›¡ï¸ Layer 7é˜²å¾¡æ‰‹æ³•ï¼ˆæ—¥æœ¬ï¼‰</h2>
                        <p class="chart-description">WAFã€DDoSãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒœãƒƒãƒˆç®¡ç†ãªã©ã€Cloudflareã®å„ç¨®é˜²å¾¡æ©Ÿèƒ½ã«ã‚ˆã‚‹æ”»æ’ƒã®é®æ–­å‰²åˆã€‚</p>
                        <div class="chart-container">
                            <canvas id="japanL7MitigationChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-section">
                        <h2>âš¡ Layer 3ãƒ—ãƒ­ãƒˆã‚³ãƒ«åˆ¥ï¼ˆæ—¥æœ¬ï¼‰</h2>
                        <p class="chart-description">UDPã€TCPã€ICMPãªã©ã€DDoSæ”»æ’ƒã«ä½¿ç”¨ã•ã‚ŒãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®å†…è¨³ã€‚</p>
                        <div class="chart-container">
                            <canvas id="japanL3ProtocolChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-section">
                        <h2>ğŸ¤– ãƒœãƒƒãƒˆ vs äººé–“ï¼ˆæ—¥æœ¬ï¼‰</h2>
                        <p class="chart-description">Webãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å…¨ä½“ã®ã†ã¡ã€ãƒœãƒƒãƒˆï¼ˆè‡ªå‹•åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã¨äººé–“ã«ã‚ˆã‚‹é€šä¿¡ã®æ¯”ç‡ã€‚</p>
                        <div class="chart-container">
                            <canvas id="japanBotChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>ğŸŒ æ”»æ’ƒç™ºä¿¡å…ƒå›½ Top 10</h2>
                    <p class="chart-description">æ—¥æœ¬ã¸ã®æ”»æ’ƒã‚’æœ€ã‚‚å¤šãç™ºä¿¡ã—ã¦ã„ã‚‹å›½ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€‚å‰²åˆã¯æ—¥æœ¬å‘ã‘æ”»æ’ƒç·æ•°ã«å¯¾ã™ã‚‹ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã€‚</p>
                    <div class="chart-container">
                        <canvas id="japanSourceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: Cloudflare Radar API | è‡ªå‹•ç”Ÿæˆãƒ¬ãƒãƒ¼ãƒˆ</p>
        </footer>
    </div>

    <script>
        let charts = {};
        let radarData = null;

        async function loadData() {
            try {
                const response = await fetch('./data/latest.json');
                radarData = await response.json();
                
                document.getElementById('last-updated').textContent = 
                    `æœ€çµ‚æ›´æ–°: ${radarData.updated}`;
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
                
                initGlobalCharts();
                
            } catch (error) {
                document.getElementById('loading').textContent = 
                    'âŒ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message;
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tab + '-tab').classList.add('active');

            if (tab === 'japan' && !charts.japanL7TrendChart) {
                initJapanCharts();
            }
        }

        function initGlobalCharts() {
            // Layer 7ãƒˆãƒ¬ãƒ³ãƒ‰
            const l7Data = radarData.global.layer7.timeseries.serie_0;
            const ctx1 = document.getElementById('globalL7TrendChart').getContext('2d');
            charts.globalL7TrendChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: l7Data.timestamps.map(t => {
                        const d = new Date(t);
                        return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:00`;
                    }),
                    datasets: [{
                        label: 'Layer 7æ”»æ’ƒ',
                        data: l7Data.values,
                        borderColor: '#f6821f',
                        backgroundColor: 'rgba(246, 130, 31, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // Layer 3ãƒˆãƒ¬ãƒ³ãƒ‰
            const l3Data = radarData.global.layer3.timeseries.serie_0;
            const ctx2 = document.getElementById('globalL3TrendChart').getContext('2d');
            charts.globalL3TrendChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: l3Data.timestamps.map(t => {
                        const d = new Date(t);
                        return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:00`;
                    }),
                    datasets: [{
                        label: 'Layer 3 DDoSæ”»æ’ƒ',
                        data: l3Data.values,
                        borderColor: '#c33',
                        backgroundColor: 'rgba(204, 51, 51, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // Layer 7é˜²å¾¡æ‰‹æ³•
            const l7Summary = radarData.global.layer7.summary.summary_0;
            const ctx3 = document.getElementById('globalL7MitigationChart').getContext('2d');
            charts.globalL7MitigationChart = new Chart(ctx3, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(l7Summary).filter(k => parseFloat(l7Summary[k]) > 0),
                    datasets: [{
                        data: Object.values(l7Summary).filter(v => parseFloat(v) > 0),
                        backgroundColor: ['#f6821f', '#ff6b35', '#ffb347', '#ffd699', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // Layer 3ãƒ—ãƒ­ãƒˆã‚³ãƒ«
            const l3Protocol = radarData.global.layer3.protocol.summary_0;
            const ctx4 = document.getElementById('globalL3ProtocolChart').getContext('2d');
            charts.globalL3ProtocolChart = new Chart(ctx4, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(l3Protocol).filter(k => parseFloat(l3Protocol[k]) > 0),
                    datasets: [{
                        data: Object.values(l3Protocol).filter(v => parseFloat(v) > 0),
                        backgroundColor: ['#c33', '#ff6b35', '#ffb347', '#ffd699', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // ãƒœãƒƒãƒˆ vs äººé–“
            const botData = radarData.global.bot.class.summary_0;
            const ctx5 = document.getElementById('globalBotChart').getContext('2d');
            charts.globalBotChart = new Chart(ctx5, {
                type: 'pie',
                data: {
                    labels: Object.keys(botData),
                    datasets: [{
                        data: Object.values(botData),
                        backgroundColor: ['#4CAF50', '#FF9800']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // æ”»æ’ƒå¯¾è±¡å›½
            const locations = radarData.global.layer7.locations.top_0;
            const ctx6 = document.getElementById('globalLocationChart').getContext('2d');
            charts.globalLocationChart = new Chart(ctx6, {
                type: 'bar',
                data: {
                    labels: locations.map(l => l.targetCountryName),
                    datasets: [{
                        label: 'æ”»æ’ƒå‰²åˆ (%)',
                        data: locations.map(l => parseFloat(l.value)),
                        backgroundColor: '#f6821f'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } }
                }
            });
        }

        function initJapanCharts() {
            // Layer 7ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆæ—¥æœ¬ï¼‰
            const l7Data = radarData.japan.layer7.timeseries.serie_0;
            const ctx1 = document.getElementById('japanL7TrendChart').getContext('2d');
            charts.japanL7TrendChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: l7Data.timestamps.map(t => {
                        const d = new Date(t);
                        return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:00`;
                    }),
                    datasets: [{
                        label: 'Layer 7æ”»æ’ƒï¼ˆæ—¥æœ¬ï¼‰',
                        data: l7Data.values,
                        borderColor: '#f6821f',
                        backgroundColor: 'rgba(246, 130, 31, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // Layer 3ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆæ—¥æœ¬ï¼‰
            const l3Data = radarData.japan.layer3.timeseries.serie_0;
            const ctx2 = document.getElementById('japanL3TrendChart').getContext('2d');
            charts.japanL3TrendChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: l3Data.timestamps.map(t => {
                        const d = new Date(t);
                        return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:00`;
                    }),
                    datasets: [{
                        label: 'Layer 3 DDoSæ”»æ’ƒï¼ˆæ—¥æœ¬ï¼‰',
                        data: l3Data.values,
                        borderColor: '#c33',
                        backgroundColor: 'rgba(204, 51, 51, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // Layer 7é˜²å¾¡æ‰‹æ³•ï¼ˆæ—¥æœ¬ï¼‰
            const l7Summary = radarData.japan.layer7.summary.summary_0;
            const ctx3 = document.getElementById('japanL7MitigationChart').getContext('2d');
            charts.japanL7MitigationChart = new Chart(ctx3, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(l7Summary).filter(k => parseFloat(l7Summary[k]) > 0),
                    datasets: [{
                        data: Object.values(l7Summary).filter(v => parseFloat(v) > 0),
                        backgroundColor: ['#f6821f', '#ff6b35', '#ffb347', '#ffd699', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // Layer 3ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆæ—¥æœ¬ï¼‰
            const l3Protocol = radarData.japan.layer3.protocol.summary_0;
            const ctx4 = document.getElementById('japanL3ProtocolChart').getContext('2d');
            charts.japanL3ProtocolChart = new Chart(ctx4, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(l3Protocol).filter(k => parseFloat(l3Protocol[k]) > 0),
                    datasets: [{
                        data: Object.values(l3Protocol).filter(v => parseFloat(v) > 0),
                        backgroundColor: ['#c33', '#ff6b35', '#ffb347', '#ffd699', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // ãƒœãƒƒãƒˆ vs äººé–“ï¼ˆæ—¥æœ¬ï¼‰
            const botData = radarData.japan.bot.class.summary_0;
            const ctx5 = document.getElementById('japanBotChart').getContext('2d');
            charts.japanBotChart = new Chart(ctx5, {
                type: 'pie',
                data: {
                    labels: Object.keys(botData),
                    datasets: [{
                        data: Object.values(botData),
                        backgroundColor: ['#4CAF50', '#FF9800']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });

            // æ”»æ’ƒç™ºä¿¡å…ƒå›½
            const sources = radarData.japan.layer7.sources.top_0;
            const ctx6 = document.getElementById('japanSourceChart').getContext('2d');
            charts.japanSourceChart = new Chart(ctx6, {
                type: 'bar',
                data: {
                    labels: sources.map(l => l.originCountryName),
                    datasets: [{
                        label: 'æ”»æ’ƒå‰²åˆ (%)',
                        data: sources.map(l => parseFloat(l.value)),
                        backgroundColor: '#f6821f'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } }
                }
            });
        }

        window.addEventListener('load', loadData);
    </script>
</body>
</html>